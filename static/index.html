<!DOCTYPE html>
<html>
  <head>
    <title>Proxy Service</title>
    <link rel="icon" href="https://glitch.com/favicon.ico" />
    <meta charset="utf-8" />
  </head>
  <body>
    This is a proxy service. Rejoice! Go to:
    <input type="text" id="go" /><button id="button">Go!</button><br />
    <span id="error" style="color: red"></span>
    <script type="module">
      import { isValidURL, proxyURL } from "/utils.js?proxyresource";
      const input = document.getElementById("go");
      const error = document.getElementById("error");
      const button = document.getElementById("button");

      button.onclick = () => {
        let hasError = false
        if (isValidURL(input.value)) {
          try {
            window.location.href = proxyURL(input.value);
          } catch (e) {
            console.error(e)
            hasError = true
          }
        } else {
          hasError = true
        }
        if (hasError) {
          error.innerHTML = "Oops, that is not a valid url. Try again!";
        }
      };
    </script>
  </body>
</html>
